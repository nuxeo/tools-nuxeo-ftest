<project>


  <profiles>

    <profile>
      <id>cargo</id>
      <activation>
        <property>
          <name>launcher</name>
          <value>cargo</value>
        </property>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>org.nuxeo.build</groupId>
            <artifactId>ant-assembly-maven-plugin</artifactId>
            <executions>
              <execution>
                <id>pack-war</id>
                <phase>package</phase>
                <goals>
                  <goal>build</goal>
                </goals>
                <configuration>
                  <buildFile>${buildFile}</buildFile>
                  <target>pack-war</target>
                </configuration>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <groupId>org.codehaus.cargo</groupId>
            <artifactId>cargo-maven2-plugin</artifactId>
            <configuration>
              <configuration>
                <properties>
                  <cargo.servlet.port>8080</cargo.servlet.port>
                </properties>
              </configuration>
              <deployables>
                <deployable>
                  <type>war</type>
                  <location>target/nuxeo.war</location>
                  <pingURL>http://localhost:8080/nuxeo/runningstatus</pingURL>
                  <pingTimeout>60000</pingTimeout>
                </deployable>
              </deployables>
            </configuration>
            <executions>
              <execution>
                <id>start-cargo</id>
                <phase>pre-integration-test</phase>
                <goals>
                  <goal>start</goal>
                </goals>
                <configuration>
                  <configuration>
                    <properties>
                      <cargo.jvmargs>
                        -Xdebug
                        -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8787
                        -Xnoagent
                        -Djava.compiler=NONE
                        -Xmx512m
                      </cargo.jvmargs>
                    </properties>
                  </configuration>
                </configuration>
              </execution>
              <execution>
                <id>stop-cargo</id>
                <phase>post-integration-test</phase>
                <goals>
                  <goal>stop</goal>
                </goals>
              </execution>
            </executions>
          </plugin>
        </plugins>
        </build>
    </profile>
    <profile>
      <id>jetty7x</id>
      <activation>
        <property>
          <name>container</name>
          <value>jetty7x</value>
        </property>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>org.codehaus.cargo</groupId>
            <artifactId>cargo-maven2-plugin</artifactId>
            <configuration>
              <container>
                <containerId>jetty7x</containerId>
                <artifactInstaller>
                  <groupId>org.eclipse.jetty</groupId>
                  <artifactId>jetty-distribution</artifactId>
                  <version>7.6.16.v20140903</version>
                </artifactInstaller>
              </container>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>

    <profile>
      <id>tomcat7x</id>
      <activation>
        <property>
          <name>container</name>
          <value>tomcat7x</value>
        </property>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>org.codehaus.cargo</groupId>
            <artifactId>cargo-maven2-plugin</artifactId>
            <configuration>
              <container>
                <containerId>tomcat7x</containerId>
                <zipUrlInstaller>
                  <url>http://archive.apache.org/dist/tomcat/tomcat-7/v7.0.57/bin/apache-tomcat-7.0.57.zip</url>
                </zipUrlInstaller>
              </container>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>

    <profile>
      <id>glassfish3x</id>
      <activation>
        <property>
          <name>container</name>
          <value>glassfish3x</value>
        </property>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>org.codehaus.cargo</groupId>
            <artifactId>cargo-maven2-plugin</artifactId>
            <configuration>
              <container>
                <containerId>glassfish3x</containerId>
                <artifactInstaller>
                  <groupId>org.glassfish.main.distributions</groupId>
                  <artifactId>glassfish</artifactId>
                  <version>3.1.2.2</version>
                </artifactInstaller>
              </container>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>

    <profile>
      <id>geronimo3x</id>
      <activation>
        <property>
          <name>container</name>
          <value>glassfish3x</value>
        </property>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>org.codehaus.cargo</groupId>
            <artifactId>cargo-maven2-plugin</artifactId>
            <configuration>
              <container>
                <containerId>geronimo3x</containerId>
                <artifactInstaller>
                  <groupId>org.apache.geronimo.assemblies</groupId>
                  <artifactId>geronimo-tomcat7-javaee6</artifactId>
                  <version>3.0.1</version>
                  <classifier>bin</classifier>
                </artifactInstaller>
              </container>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>

    <profile>
      <id>wildfly8x</id>
      <activation>
        <property>
          <name>container</name>
          <value>wildfly8x</value>
        </property>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>org.codehaus.cargo</groupId>
            <artifactId>cargo-maven2-plugin</artifactId>
            <configuration>
              <container>
                <containerId>wildfly8x</containerId>
                <artifactInstaller>
                  <groupId>org.wildfly</groupId>
                  <artifactId>wildfly-dist</artifactId>
                  <version>8.2.0.Final</version>
                </artifactInstaller>
              </container>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
  </profiles>

</project>
